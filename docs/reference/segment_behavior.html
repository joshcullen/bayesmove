<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Segmentation model to estimate breakpoints — segment_behavior • bayesmove</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Segmentation model to estimate breakpoints — segment_behavior" />
<meta property="og:description" content="This function performs the reversible-jump MCMC algorithm using a Gibbs
sampler, which estimates the breakpoints of the movement variables for each
of the animal IDs. This is the first stage of the two-stage Bayesian model that
estimates proportions of behavioral states by first segmenting individual
tracks into relatively homogeneous segments of movement." />
<meta property="og:image" content="http://joshcullen.github.io/bayesmove/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151357058-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151357058-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesmove</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Prepare-data-for-analysis.html">Prepare Data</a>
    </li>
    <li>
      <a href="../articles/Segment-the-tracks.html">Segment the Tracks</a>
    </li>
    <li>
      <a href="../articles/Cluster-track-segments.html">Cluster Track Segments</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/joshcullen/bayesmove">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Segmentation model to estimate breakpoints</h1>
    <small class="dont-index">Source: <a href='https://github.com/joshcullen/bayesmove/blob/master/R/segmentation_gibbs_sampler.R'><code>R/segmentation_gibbs_sampler.R</code></a></small>
    <div class="hidden name"><code>segment_behavior.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs the reversible-jump MCMC algorithm using a Gibbs
sampler, which estimates the breakpoints of the movement variables for each
of the animal IDs. This is the first stage of the two-stage Bayesian model that
estimates proportions of behavioral states by first segmenting individual
tracks into relatively homogeneous segments of movement.</p>
    </div>

    <pre class="usage"><span class='fu'>segment_behavior</span>(
  <span class='no'>data</span>,
  <span class='no'>ngibbs</span>,
  <span class='no'>nbins</span>,
  <span class='no'>alpha</span>,
  <span class='kw'>breakpt</span> <span class='kw'>=</span> <span class='kw pkg'>purrr</span><span class='kw ns'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>data</span>), ~<span class='kw'>NULL</span>)
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A list where each element stores the data for a separate animal
ID. List elements are data frames that only contain columns for the animal
ID and for each of the discretized movement variables.</p></td>
    </tr>
    <tr>
      <th>ngibbs</th>
      <td><p>numeric. The total number of iterations of the MCMC chain.</p></td>
    </tr>
    <tr>
      <th>nbins</th>
      <td><p>numeric. A vector of the number of bins used to discretize each
movement variable. These must be in the same order as the columns within
<code>data</code>.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>numeric. A single value used to specify the hyperparameter for
the prior distribution. A standard value for <code>alpha</code> is typically 1,
which corresponds with a vague prior on the Dirichlet distribution.</p></td>
    </tr>
    <tr>
      <th>breakpt</th>
      <td><p>A list where each element stores a vector of breakpoints if
pre-specifying where they may occur for each animal ID. By default this is
set to <code>NULL</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of model results is returned where elements include the
  breakpoints, number of breakpoints, and log marginal likelihood at each
  iteration of the MCMC chain for all animal IDs. The time it took the model
  to finish running for each animal ID are also stored and returned.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This model is run in parallel using the <code>future</code> package. To ensure that
the model is run in parallel, the <code><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></code> must be used
with <code>multisession</code> as the argument for most operating systems.
Otherwise, model will run sequentially by default if this is not set before
running <code>segment_behavior</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='co'>#load data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>tracks.list</span>)

<span class='co'>#only retain id and discretized step length (SL) and turning angle (TA) columns</span>
<span class='no'>tracks.list2</span><span class='kw'>&lt;-</span> <span class='fu'>map</span>(<span class='no'>tracks.list</span>,
                   <span class='no'>subset</span>,
                  <span class='kw'>select</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>id</span>, <span class='no'>SL</span>, <span class='no'>TA</span>))</div><div class='output co'>#&gt; <span class='error'>Error in map(tracks.list, subset, select = c(id, SL, TA)): could not find function "map"</span></div><div class='input'>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)

<span class='co'># Define model params</span>
<span class='no'>alpha</span><span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>ngibbs</span><span class='kw'>&lt;-</span> <span class='fl'>10000</span>
<span class='no'>nbins</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>8</span>)

<span class='kw pkg'>future</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></span>(<span class='no'>multisession</span>)  <span class='co'>#run all MCMC chains in parallel</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(first, envir = parent.frame(), enclos = baseenv()): object 'multisession' not found</span></div><div class='input'><span class='no'>dat.res</span><span class='kw'>&lt;-</span> <span class='fu'>segment_behavior</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>tracks.list2</span>, <span class='kw'>ngibbs</span> <span class='kw'>=</span> <span class='no'>ngibbs</span>, <span class='kw'>nbins</span> <span class='kw'>=</span> <span class='no'>nbins</span>,
                           <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='no'>alpha</span>)</div><div class='output co'>#&gt; <span class='error'>Error in future_map2_template(purrr::map, "list", .x, .y, .f, ..., .progress = .progress,     .options = .options): object 'tracks.list2' not found</span></div><div class='input'>
<span class='kw pkg'>future</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></span>(<span class='kw pkg'>future</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/future/man/sequential.html'>sequential</a></span>)
<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joshua Cullen, Denis Valle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


