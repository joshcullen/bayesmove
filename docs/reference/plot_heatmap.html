<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot breakpoints over a time series heatmap of the movement variables — plot_heatmap • bayesmove</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot breakpoints over a time series heatmap of the movement variables — plot_heatmap" />
<meta property="og:description" content="Visualize the breakpoints estimated by the segmentation model as they relate
to the discretized data on which the model was performed. These plots assist
in determining whether too many or too few breakpoints were estimated as well
as whether the user needs to redefine how they discretized their data before
analysis." />
<meta property="og:image" content="http://joshcullen.github.io/bayesmove/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151357058-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151357058-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesmove</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Prepare-data-for-analysis.html">Prepare Data</a>
    </li>
    <li>
      <a href="../articles/Segment-the-tracks.html">Segment the Tracks</a>
    </li>
    <li>
      <a href="../articles/Cluster-track-segments.html">Cluster Track Segments</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/joshcullen/bayesmove">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot breakpoints over a time series heatmap of the movement variables</h1>
    <small class="dont-index">Source: <a href='https://github.com/joshcullen/bayesmove/blob/master/R/segmentation_helper_functions.R'><code>R/segmentation_helper_functions.R</code></a></small>
    <div class="hidden name"><code>plot_heatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Visualize the breakpoints estimated by the segmentation model as they relate
to the discretized data on which the model was performed. These plots assist
in determining whether too many or too few breakpoints were estimated as well
as whether the user needs to redefine how they discretized their data before
analysis.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_heatmap</span>(<span class='no'>data</span>, <span class='no'>nbins</span>, <span class='no'>brkpts</span>, <span class='no'>title</span>, <span class='no'>legend</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A list where each element stores a data frame for a given animal
ID. Each of these data frames contain only columns for the ID and each of
the movement variables that were analyzed by
<code><a href='segment_behavior.html'>segment_behavior</a></code>. The ID column must be first.</p></td>
    </tr>
    <tr>
      <th>nbins</th>
      <td><p>numeric. A vector of the number of bins used to discretize each
movement variable. These must be in the same order as the columns within
<code>data</code>.</p></td>
    </tr>
    <tr>
      <th>brkpts</th>
      <td><p>A data frame that contains the breakpoints associated with each
animal ID. This data frame is returned by <code><a href='get_breakpts.html'>get_breakpts</a></code>.</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>logical. If <code>TRUE</code>, includes the animal ID as the title of
the plot.</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p>logical. If <code>TRUE</code>, shows the legend for the heatmap.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A heatmap per animal ID that shows the value of each movement
  variable over time (as discretized into bins) and is overlayed by the
  extracted breakpoints.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#simulate data</span>
<span class='no'>step</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>rgamma</a></span>(<span class='fl'>1000</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2.5</span>, <span class='fl'>10</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>))
<span class='no'>angle</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>1000</span>, -<span class='no'>pi</span>, <span class='no'>pi</span>)
<span class='no'>date</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/ISOdatetime.html'>ISOdate</a></span>(<span class='fl'>2020</span>, <span class='fl'>6</span>, <span class='fl'>17</span>, <span class='kw'>tz</span> <span class='kw'>=</span> <span class='st'>"UTC"</span>)), <span class='kw'>by</span> <span class='kw'>=</span> <span class='st'>"hour"</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='fl'>1000</span>)
<span class='no'>date</span><span class='kw'>&lt;-</span> <span class='no'>date</span> + <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/period.html'>seconds</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>date</span>), -<span class='fl'>15</span>, <span class='fl'>15</span>))  <span class='co'>#introduce noise</span>
<span class='no'>dt</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span>(<span class='no'>date</span>)) * <span class='fl'>60</span>  <span class='co'>#convert time difference to seconds</span>
<span class='no'>dt</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>dt</span>, <span class='fl'>NA</span>)
<span class='no'>var</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='fl'>100</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>10</span>)
<span class='no'>id</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>100</span>)


<span class='co'>#create data frame and round time</span>
<span class='no'>dat</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>id</span>, <span class='no'>date</span>, <span class='no'>dt</span>, <span class='no'>step</span>, <span class='no'>angle</span>, <span class='no'>var</span>)
<span class='no'>dat</span><span class='kw'>&lt;-</span> <span class='fu'><a href='round_track_time.html'>round_track_time</a></span>(<span class='kw'>dat</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>id</span> <span class='kw'>=</span> <span class='st'>"id"</span>, <span class='kw'>int</span> <span class='kw'>=</span> <span class='fl'>3600</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>15</span>, <span class='kw'>time.zone</span> <span class='kw'>=</span> <span class='st'>"UTC"</span>)


<span class='co'>#define limits for each bin</span>
<span class='no'>dist.lims</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>step</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0.25</span>, <span class='fl'>0.5</span>, <span class='fl'>0.75</span>, <span class='fl'>0.95</span>)), <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='no'>step</span>))  <span class='co'>#5 bins</span>
<span class='no'>angle.lims</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='no'>pi</span>, -<span class='fl'>3</span>*<span class='no'>pi</span>/<span class='fl'>4</span>, -<span class='no'>pi</span>/<span class='fl'>2</span>, -<span class='no'>pi</span>/<span class='fl'>4</span>, <span class='fl'>0</span>, <span class='no'>pi</span>/<span class='fl'>4</span>, <span class='no'>pi</span>/<span class='fl'>2</span>, <span class='fl'>3</span>*<span class='no'>pi</span>/<span class='fl'>4</span>, <span class='no'>pi</span>)  <span class='co'>#8 bins</span>

<span class='co'>#discretize step and angle</span>
<span class='no'>dat1</span><span class='kw'>&lt;-</span> <span class='fu'><a href='discrete_move_var.html'>discrete_move_var</a></span>(<span class='kw'>dat</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>lims</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>dist.lims</span>, <span class='no'>angle.lims</span>),
                         <span class='kw'>varIn</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"step"</span>, <span class='st'>"angle"</span>),
                         <span class='kw'>varOut</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"SL"</span>,<span class='st'>"TA"</span>))


<span class='co'>#create list and filter by primary time step</span>
<span class='no'>dat.list</span><span class='kw'>&lt;-</span> <span class='fu'><a href='df_to_list.html'>df_to_list</a></span>(<span class='kw'>dat</span> <span class='kw'>=</span> <span class='no'>dat1</span>, <span class='kw'>ind</span> <span class='kw'>=</span> <span class='st'>"id"</span>)
<span class='no'>dat.list.filt</span><span class='kw'>&lt;-</span> <span class='fu'><a href='filter_time.html'>filter_time</a></span>(<span class='kw'>dat.list</span> <span class='kw'>=</span> <span class='no'>dat.list</span>, <span class='kw'>int</span> <span class='kw'>=</span> <span class='fl'>3600</span>)
<span class='no'>dat.list.filt1</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>dat.list.filt</span>,
                        <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>x</span>, <span class='kw'>select</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>id</span>, <span class='no'>SL</span>, <span class='no'>TA</span>)))


<span class='co'>#simulate breakpoints</span>
<span class='no'>brkpts</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='fl'>65</span>, <span class='fl'>7</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)), <span class='fl'>10</span>)
<span class='no'>brkpts</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='no'>brkpts</span>, <span class='fl'>10</span>, <span class='fl'>7</span>, <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>brkpts</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>id</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>10</span>, <span class='no'>brkpts</span>)


<span class='co'>#run function</span>
<span class='fu'>plot_heatmap</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat.list.filt1</span>, <span class='kw'>nbins</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>8</span>), <span class='kw'>brkpts</span> <span class='kw'>=</span> <span class='no'>brkpts</span>,
             <span class='kw'>title</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>legend</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joshua Cullen, Denis Valle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


